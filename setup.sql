CREATE TABLE exploits (
	id DECIMAL NOT NULL,
	file VARCHAR(41) NOT NULL,
	description VARCHAR(244) NOT NULL,
	date DATE NOT NULL,
	author VARCHAR(65) NOT NULL,
	type VARCHAR(7) NOT NULL,
	platform VARCHAR(14) NOT NULL,
	port DECIMAL
);

CREATE VIRTUAL TABLE exploits_search USING fts5(
	description,
	file UNINDEXED,
	date UNINDEXED,
	author UNINDEXED,
	type UNINDEXED,
	platform UNINDEXED,
	port UNINDEXED,
	content='exploits',
	content_rowid='id'
);

CREATE TRIGGER exploits_ai AFTER INSERT ON exploits BEGIN
  INSERT INTO exploits_search(
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	port
  ) VALUES (
  	new.id,
  	new.description,
  	new.file,
	new.date,
	new.author,
	new.type,
	new.platform,
	new.port
  );
END;

CREATE TRIGGER exploits_ad AFTER DELETE ON exploits BEGIN
  INSERT INTO exploits_search(
  	exploits_search,
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	port
  ) VALUES(
  	'delete',
  	old.id,
  	old.description,
	old.file,
	old.date,
	old.author,
	old.type,
	old.platform,
	old.port
  );
END;

CREATE TRIGGER exploits_au AFTER UPDATE ON exploits BEGIN
  INSERT INTO exploits_search(
  	exploits_search,
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	port
  ) VALUES(
  	'delete',
  	old.id,
  	old.description,
	old.file,
	old.date,
	old.author,
	old.type,
	old.platform,
	old.port
  );
  INSERT INTO exploits_search(
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	port
  ) VALUES (
  	new.id,
  	new.description,
  	new.file,
	new.date,
	new.author,
	new.type,
	new.platform,
	new.port
  );
END;

CREATE TABLE papers (
	id DECIMAL NOT NULL, 
	file VARCHAR(175) NOT NULL, 
	description VARCHAR(152) NOT NULL, 
	date DATE NOT NULL, 
	author VARCHAR(56) NOT NULL, 
	type BOOLEAN, 
	platform VARCHAR(14) NOT NULL, 
	language VARCHAR(13) NOT NULL, 
	CHECK (type IN (0, 1))
);

CREATE VIRTUAL TABLE papers_search USING fts5(
	description, 
	file UNINDEXED, 
	date UNINDEXED, 
	author UNINDEXED, 
	type UNINDEXED, 
	platform UNINDEXED, 
	language UNINDEXED, 
	content='papers',
	content_rowid='id'
);

CREATE TRIGGER papers_ai AFTER INSERT ON papers BEGIN
  INSERT INTO papers_search(
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	language
  ) VALUES (
  	new.id,
  	new.description,
  	new.file,
	new.date,
	new.author,
	new.type,
	new.platform,
	new.language
  );
END;

CREATE TRIGGER papers_ad AFTER DELETE ON papers BEGIN
  INSERT INTO papers_search(
  	papers_search,
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	language
  ) VALUES(
  	'delete',
  	old.id,
  	old.description,
	old.file,
	old.date,
	old.author,
	old.type,
	old.platform,
	old.language
  );
END;

CREATE TRIGGER papers_au AFTER UPDATE ON papers BEGIN
  INSERT INTO papers_search(
  	papers_search,
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	language
  ) VALUES(
  	'delete',
  	old.id,
  	old.description,
	old.file,
	old.date,
	old.author,
	old.type,
	old.platform,
	old.language
  );
  INSERT INTO papers_search(
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform,
	language
  ) VALUES (
  	new.id,
  	new.description,
  	new.file,
	new.date,
	new.author,
	new.type,
	new.platform,
	new.language
  );
END;

CREATE TABLE shellcodes (
	id DECIMAL NOT NULL, 
	file VARCHAR(35) NOT NULL, 
	description VARCHAR(174) NOT NULL, 
	date DATE NOT NULL, 
	author VARCHAR(30) NOT NULL, 
	type VARCHAR(9) NOT NULL, 
	platform VARCHAR(14) NOT NULL
);

CREATE VIRTUAL TABLE shellcodes_search USING fts5(
	description, 
	file UNINDEXED, 
	date UNINDEXED, 
	author UNINDEXED, 
	type UNINDEXED, 
	platform UNINDEXED, 
	content='shellcodes',
	content_rowid='id'
);

CREATE TRIGGER shellcodes_ai AFTER INSERT ON shellcodes BEGIN
  INSERT INTO shellcodes_search(
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform
  ) VALUES (
  	new.id,
  	new.description,
  	new.file,
	new.date,
	new.author,
	new.type,
	new.platform
  );
END;

CREATE TRIGGER shellcodes_ad AFTER DELETE ON shellcodes BEGIN
  INSERT INTO shellcodes_search(
  	shellcodes_search,
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform
  ) VALUES(
  	'delete',
  	old.id,
  	old.description,
	old.file,
	old.date,
	old.author,
	old.type,
	old.platform
  );
END;

CREATE TRIGGER shellcodes_au AFTER UPDATE ON shellcodes BEGIN
  INSERT INTO shellcodes_search(
  	shellcodes_search,
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform
  ) VALUES(
  	'delete',
  	old.id,
  	old.description,
	old.file,
	old.date,
	old.author,
	old.type,
	old.platform
  );
  INSERT INTO shellcodes_search(
  	rowid,
  	description,
	file,
	date,
	author,
	type,
	platform
  ) VALUES (
  	new.id,
  	new.description,
  	new.file,
	new.date,
	new.author,
	new.type,
	new.platform
  );
END;